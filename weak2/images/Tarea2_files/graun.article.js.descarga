(window.webpackJsonp=window.webpackJsonp||[]).push([[2,31],{146:function(t,e,n){var i=n(288);t.exports=function(t){return i(2,t)}},183:function(t,e,n){var i=n(40),o=n(18);t.exports=function(t,e,n){var a=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return o(n)&&(a="leading"in n?!!n.leading:a,r="trailing"in n?!!n.trailing:r),i(t,e,{leading:a,maxWait:e,trailing:r})}},217:function(t,e,n){var i=n(290),o=n(286)((function(t,e){return null==t?{}:i(t,e)}));t.exports=o},285:function(t,e,n){var i=n(289);t.exports=function(t){var e=i(t),n=e%1;return e==e?n?e-n:e:0}},286:function(t,e,n){var i=n(287),o=n(184),a=n(182);t.exports=function(t){return a(o(t,void 0,i),t+"")}},287:function(t,e,n){var i=n(170);t.exports=function(t){return null!=t&&t.length?i(t,1):[]}},288:function(t,e,n){var i=n(285);t.exports=function(t,e){var n;if("function"!=typeof e)throw new TypeError("Expected a function");return t=i(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}},290:function(t,e,n){var i=n(214),o=n(215);t.exports=function(t,e){return i(t,e,(function(e,n){return o(t,n)}))}},390:function(t,e,n){"use strict";n.r(e),n.d(e,"initTrails",(function(){return pt}));var i=n(11),o=n(32),a=n.n(o),r=n(12),s=n(0),c=n(181),l=n(389),u=n(420),d=n(16),h=n(415),f=n(21),p=n.n(f),m=n(27),g=n.n(m),v=n(78),b=n.n(v),y=n(79),w=n.n(y),x=n(47),j=n.n(x),_=n(58),k=n(8);var C=function(t){b()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=j()(t);if(e){var o=j()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return w()(this,n)}}(n);function n(){var t;p()(this,n),t=e.call(this);var i=s.a.get("page.section"),o=i&&!["info","global"].includes(i);return t.endpoint="/most-read".concat(o?"/".concat(i):"",".json"),k.a.emit("register:begin","popular-in-section"),t.fetch(a()(".js-popular-trails"),"html"),t}return g()(n,[{key:"ready",value:function(){k.a.emit("modules:popular:loaded"),k.a.emit("register:end","popular-in-section")}}]),n}(_.a),E=n(15),T=n.n(E),O=n(6),S=n(384),R=n(2),A=n.n(R),I=function(){function t(e){p()(this,t),A()(this,"opts",void 0),A()(this,"dom",void 0),A()(this,"cta",void 0),A()(this,"expanded",void 0),A()(this,"showCount",void 0),this.opts=e,this.dom=e.dom,this.expanded=!1!==e.expanded,this.cta=document.createElement("button"),this.showCount=!1!==e.showCount}return g()(t,[{key:"renderState",value:function(){this.expanded?this.dom.classList.remove("shut"):this.dom.classList.add("shut")}},{key:"getCount",value:function(){return parseInt(this.dom.getAttribute("data-count")||"0",10)}},{key:"updateCallToAction",value:function(){var t="Show ".concat(this.showCount?"".concat(this.getCount()," "):"").concat(this.expanded?"fewer":"more");this.cta.innerHTML=t,this.cta.setAttribute("data-link-name","Show ".concat(this.expanded?"more":"fewer")),this.cta.setAttribute("data-is-ajax","1")}},{key:"toggleExpanded",value:function(){this.expanded=!this.expanded,this.renderState(),this.updateCallToAction()}},{key:"isOpen",value:function(){return!this.dom.classList.contains("shut")}},{key:"renderCallToAction",value:function(){var t=this;this.cta.addEventListener("click",(function(){t.toggleExpanded()})),this.cta.className="cta",this.opts.buttonAfterEl?this.opts.buttonAfterEl.insertAdjacentElement("afterend",this.cta):this.dom.appendChild(this.cta),this.updateCallToAction()}},{key:"scrollToCallToAction",value:function(){var t=this;this.expanded||window.setTimeout((function(){t.cta.scrollIntoView()}),550)}},{key:"init",value:function(){this.dom.classList.contains("expandable-initialised")||!this.dom.innerHTML||this.getCount()<3||(this.dom.classList.add("expandable-initialised"),this.renderCallToAction(),this.renderState())}},{key:"toggle",value:function(){this.toggleExpanded()}}]),t}(),L=n(145),M=function(t){new I({dom:t,expanded:!1,showCount:!1}).init()},P=n(64),$=n.n(P);var B,q,H={uk:{comment:"uk-alpha/contributors/feature-stories"},us:{comment:"us-alpha/contributors/feature-stories"},au:{comment:"au-alpha/contributors/feature-stories"},int:{comment:"ee3386bb-9430-4a6d-8bca-b99d65790f3b"}},D=function(t){b()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=j()(t);if(e){var o=j()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return w()(this,n)}}(n);function n(){var t;return p()(this,n),t=e.call(this),A()($()(t),"edition",void 0),Object(S.a)("tonal-content"),t.edition=s.a.get("page.edition","").toLowerCase(),t.isSupported()&&(t.endpoint=t.getEndpoint()),t}return g()(n,null,[{key:"getTone",value:function(){return s.a.get("page.tones","").split(",")[0].toLowerCase()}},{key:"ready",value:function(){k.a.emit("modules:tonal:loaded"),Object(S.b)("tonal-content")}},{key:"error",value:function(){Object(S.c)("tonal-content")}}]),g()(n,[{key:"getEndpoint",value:function(){var t=H[this.edition][n.getTone()];return"/container/".concat(t,".json")}},{key:"isSupported",value:function(){return n.getTone()in H[this.edition]}}]),n}(_.a),z=n(17),N=n.n(z),F=n(9),U=n(396),W=n(207),J=n.n(W),K=n(208),X=n(416),V=n.n(X),Z=n(417),G=n.n(Z),Q=Object(r.a)(".js-sharecount"),Y={facebook:"n/a"},tt=0,et=function(){var t="".concat(s.a.get("page.ajaxUrl"),"/sharecount/").concat(s.a.get("page.pageId"),".json");Object(O.a)(t,{mode:"cors"}).then((function(t){var e=t.share_count||0;Y.facebook=e,e>0&&(function(t){var e=Object(K.a)("share"),n=Q.hasClass("js-sharecount-immersive")?G.a:V.a,i=J()(n)({icon:e});Q.removeClass("u-h").html(i).css("display",""),q=Object(r.a)(".sharecount__value--short",Q[0]),B=Object(r.a)(".sharecount__value--full",Q[0]),function(t){if(0!==t){var e=parseInt((tt+=t).toFixed(0),10),n=Object(U.a)(e),i=e>1e4?"".concat(Math.round(e/1e3),"k"):e;N.a.mutate((function(){B.text(n),q.text(i)}))}}(t)}(e),Q.attr("title",J()("Facebook: <%=facebook%>")(Y)))}))},nt=function(){if(s.a.get("switches.serverShareCounts")&&Q.length&&!s.a.get("page.isPreview"))try{et()}catch(t){Object(F.a)(new Error("Error retrieving share counts (".concat(t.message,")")),{feature:"share-count"},!1)}},it=n(20),ot=n.n(it),at=function(t,e,n,i){var o=new _.a;return o.manipulationType=n,o.endpoint=e+(i?"?page=".concat(i):""),t.innerHTML="",o.fetch(t,"html")},rt=n(216),st=function(){var t=s.a.get("page",{}),e=t.showRelatedContent,n=t.isPaidContent,i=t.section,o=t.shortUrl,a=t.seriesId;"Audio"!==s.a.get("page.contentType")&&"Video"!==s.a.get("page.contentType")||!e||n||!i||function(t,e,n,i,o){var a=new _.a,r=o?"/".concat(o):"",s="video"===e?"&exclude-tag=guardian-professional/guardian-professional":"",c="/".concat(e,"/section/").concat(n).concat(r,".json?shortUrl=").concat(i).concat(s);a.endpoint=c,a.fetch(t).then((function(){Object(rt.a)([t]),k.a.emit("page:media:moreinloaded",t)}))}(Object(r.a)(".js-more-in-section")[0],s.a.get("page.contentType","").toLowerCase(),i,o,a)},ct=function(t,e){window.location.hash?e():i.a.measure((function(){return document.querySelector(t)})).then((function(t){t&&Object(l.a)(t,1500,e)}))},lt=function(){s.a.get("page.isFront")||ct(".js-popular-trails",(function(){new C}))},ut=function(){s.a.get("page.seriesId")||s.a.get("page.blogIds")||ct(".js-related",(function(){var t={excludeTags:[]};"paid-content"!==s.a.get("page.sponsorshipType")&&t.excludeTags.push("tone/advertisement-features"),"contentType"in s.a.get("page")&&["video","interactive"].includes(s.a.get("page.contentType","").toLowerCase())&&t.excludeTags.push("guardian-professional/guardian-professional"),function(t){var e,n,o,a=L.a.adFree&&s.a.get("page.isPaidContent");if(s.a.get("page.hasStoryPackage")){var r=document.body&&document.body.querySelector(".related-trails");r&&M(r)}else if(s.a.get("switches.relatedContent")&&s.a.get("page.showRelatedContent")&&!a){var c=document.body&&document.body.querySelector(".js-related");if(c&&!c.classList.contains("lazyloaded")){n=function(){if(!s.a.get("page.keywordIds"))return!1;var t,e,n=s.a.get("page.keywordIds","").split(","),i=s.a.get("page.isPaidContent")?n:(t=["sport/cricket","sport/rugby-union","sport/rugbyleague","sport/formulaone","sport/tennis","sport/cycling","sport/motorsports","sport/golf","sport/horse-racing","sport/boxing","sport/us-sport","sport/australia-sport","football/championsleague","football/premierleague","football/championship","football/europeanfootball","football/world-cup-2014","football/manchester-united","football/chelsea","football/arsenal","football/manchestercity","football/tottenham-hotspur","football/liverpool"],e=n,T()(new Set(t)).filter((function(t){return new Set(e).has(t)})));return i.length?"/popular-in-tag/".concat(i[0],".json"):void 0}(),o=n?"related-popular-in-tag":"related-content",Object(S.a)(o),c.setAttribute("data-component",o),e=n||"/related/".concat(s.a.get("page.pageId"),".json");var l=t.excludeTags.map((function(t){return"exclude-tag=".concat(t)}));t.excludeTags&&t.excludeTags.length&&(e+="?".concat(l.join("&"))),Object(O.a)(e,{mode:"cors"}).then((function(t){return i.a.mutate((function(){c.innerHTML=t.html,c.classList.add("lazyloaded")}))})).then((function(){var t=c.querySelector(".related-content");t&&M(t),k.a.emit("modules:related:loaded",c),Object(S.b)(o)})).catch((function(){c.remove(),Object(S.c)(o)}))}}else Array.from(document.querySelectorAll(".js-related")).forEach((function(t){return t.classList.add("u-h")}))}(t)}))},dt=function(){ct(".js-onward",(function(){(s.a.get("page.seriesId")||s.a.get("page.blogIds"))&&s.a.get("page.showRelatedContent")?new h.a(a()(".js-onward")):""!==s.a.get("page.tones","")&&i.a.measure((function(){return Array.from(document.querySelectorAll(".js-onward"))})).then((function(t){t.forEach((function(t){(new D).fetch(t,"html")}))}))})),function(){var t=s.a.get("page.contentType","");if("Audio"===t||"Video"===t){var e=t.toLowerCase();Object(r.a)("video"===e?".js-video-components-container":".js-media-popular").each((function(t){!function(t,e){var n="video"===e?"append":"html",i=function(t){return Boolean(s.a.get("page.seriesTags"))?"/video/in-series/".concat(s.a.get("page.seriesId"),".json"):"/".concat(s.a.get("page.isPodcast")?"podcast":t,"/most-viewed.json")}(e);at(t,i,n).then((function(){!function(t,e,n){ot.a.on(t,"click",".most-viewed-navigation__button",(function(i){var o=i.target.getAttribute("data-page");return at(t,n,e,o),i.preventDefault(),!1}))}(t,n,i)}))}(t,e)}))}}(),"Audio"===s.a.get("page.contentType")&&Object(r.a)(".js-audio-components-container").each((function(t){return function(t){s.a.get("page.seriesId")&&function(t,e,n){var i=new _.a;i.manipulationType="append",i.endpoint="".concat(e,"?shortUrl=").concat(s.a.get("page.shortUrl")),t.innerHTML="",i.fetch(t,"html")}(t,"/audio/series/".concat(s.a.get("page.seriesId"),".json"))}(t)}))},ht=function(){s.a.get("switches.enableDiscussionSwitch")&&s.a.get("page.commentable")&&i.a.measure((function(){return document.querySelector(".discussion")})).then((function(t){t&&(new u.a).attachTo(t)}))},ft=function(){Object(d.k)()||i.a.measure((function(){return Object(r.a)(".js-comments")})).then((function(t){return i.a.mutate((function(){if(t.appendTo(a()(".js-repositioned-comments")),"#comments"===window.location.hash){var e=t.offset().top;Object(r.a)(document.body).scrollTop(e)}}))}))},pt=function(){Object(c.b)([["c-discussion",ht],["c-comments",ft],["c-shares",nt],["c-popular",lt],["c-related",ut],["c-onward",dt],["c-more-in-section",st]])}},391:function(t,e,n){"use strict";n.d(e,"a",(function(){return N}));var i=n(21),o=n.n(i),a=n(27),r=n.n(a),s=n(2),c=n.n(s),l=n(29),u=n(11),d=n(64),h=n.n(d),f=n(78),p=n.n(f),m=n(79),g=n.n(m),v=n(47),b=n.n(v),y=n(399),w=n.n(y),x=n(32),j=n.n(x),_=n(20),k=n.n(_),C=n(8),E=n(34),T=n.n(E);var O={waitForImages:!0,waitForLinks:!0,waitForInteractives:!1},S=function(t){return t instanceof HTMLIFrameElement},R=function(t){try{return t.contentWindow&&t.contentWindow.document&&"complete"===t.contentWindow.document.readyState}catch(t){return!0}},A=function(t){window.setTimeout(t,5e3)},I=function(t){return t.bodySelector||"document"},L=T()((function(t){var e=j()("img",t.body).filter((function(t){return!t.complete}));return 0===e.length?Promise.resolve():new Promise((function(n){var i=0;k.a.on(t.body,"load",e,(function o(){(i+=1)===e.length&&(k.a.off(t.body,"load",o),e.length=0,n())}))}))}),I),M=T()((function(t){return 0===j()(".element-rich-link--not-upgraded",t.body).length?Promise.resolve():new Promise((function(t){C.a.once("rich-link:loaded",t)}))}),I),P=T()((function(t){var e=j()(".element-interactive",t.body).filter((function(t){var e=Array.from(t.children).filter(S);return!(e.length&&R(e[0]))}));return 0!==e.length&&"MutationObserver"in window?Promise.all(e.map((function(t){return new Promise((function(e){new MutationObserver((function(t,n){if(t.length&&t[0].addedNodes.length&&S(t[0].addedNodes[0])){var i=t[0].addedNodes[0];R(i)?(n.disconnect(),e()):i.addEventListener("load",(function(){n.disconnect(),e()}))}})).observe(t,{childList:!0})}))}))).then((function(){})):Promise.resolve()}),I),$=function(t,e,n){var i=[];return t.forEach((function(t){e(t)?i.push(t):n.push(t)})),i},B=function(t,e,n){var i=e.top-n.bottom>=t.minAbove,o=n.top-e.top>=t.minBelow;return i||o},q=function(t){p()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return g()(this,n)}}(n);function n(t){var i;return o()(this,n),i=e.call(this),c()(h()(i),"name",void 0),c()(h()(i),"message",void 0),i.name="SpaceError",i.message="There is no space left matching rules from ".concat(t.bodySelector),i}return n}(w()(Error)),H=function(t){return Object.freeze({top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight,element:t})},D=function(t,e,n){t.body=t.bodySelector&&document.querySelector(t.bodySelector)||document;var i=n||{};return function(t,e){return Promise.race([new Promise(A),Promise.all([!e.waitForImages||L(t),!e.waitForLinks||M(t),!e.waitForInteractives||P(t)])]).then((function(){return t}))}(t,e||O).then((function(){return function(t,e){var n=j()(t.bodySelector+t.slotSelector);if(t.fromBottom&&n.reverse(),t.startAt){var i=!0;e.startAt=[],n=$(n,(function(e){return e===t.startAt&&(i=!1),!i}),e.startAt)}if(t.stopAt){var o=!0;e.stopAt=[],n=$(n,(function(e){return e===t.stopAt&&(o=!1),o}),e.stopAt)}return n}(t,i)})).then((function(e){return function(t,e){var n=t.clearContentMeta?document.querySelector(".js-content-meta"):null,i=t.selectors?Object.keys(t.selectors).map((function(e){return[e,j()(t.bodySelector+e)]})):null;return u.a.measure((function(){var o=t.body instanceof Element&&t.body.getBoundingClientRect(),a=e.map(H),r=t.clearContentMeta&&n?H(n):null,s=i?i.reduce((function(t,e){return t[e[0]]=e[1].map(H),t}),{}):null;return{bodyTop:o.top||0,bodyHeight:o.height||0,candidates:a,contentMeta:r,opponents:s}}))}(t,e)})).then((function(e){return function(t,e,n){var i=t.candidates;return n.absoluteMinAbove=[],i=$(i,(function(n){return!e.absoluteMinAbove||n.top+t.bodyTop>=e.absoluteMinAbove}),n.absoluteMinAbove),n.aboveAndBelow=[],i=$(i,(function(n){var i=n.top>=e.minAbove,o=n.top+e.minBelow<=t.bodyHeight;return i&&o}),n.aboveAndBelow),e.clearContentMeta&&(n.contentMeta=[],i=$(i,(function(n){return!!t.contentMeta&&n.top>t.contentMeta.bottom+e.clearContentMeta}),n.contentMeta)),e.selectors&&Object.keys(e.selectors).forEach((function(o){n[o]=[],i=$(i,(function(n){return function(t,e,n){return n.every(B.bind(void 0,t,e))}(e.selectors[o],n,t.opponents?t.opponents[o]:[])}),n[o])})),e.filter&&(n.custom=[],i=$(i,e.filter,n.custom)),i}(e,t,i)})).then((function(e){return function(t,e){if(!e.length)throw new q(t);return e.map((function(t){return t.element}))}(t,e)}))},z=function(t){return l.a.captureException(t),!1},N=new(function(){function t(){o()(this,t),c()(this,"queue",void 0),this.queue=Promise.resolve()}return r()(t,[{key:"fillSpace",value:function(t,e,n){var i=function(t){return u.a.mutate((function(){return e(t)}))},o=function(t){if(t instanceof q)return!1;throw t};return this.queue=this.queue.then((function(){return D(t,n).then(i,o)})).catch(z),this.queue}}]),t}())},392:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(21),o=n.n(i),a=n(27),r=n.n(a),s=n(2),c=n.n(s),l=n(8),u=n(17),d=n.n(u),h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o()(this,t),c()(this,"element",void 0),c()(this,"opts",void 0),c()(this,"offsetFromParent",void 0),c()(this,"lastMessage",void 0),this.element=e,this.opts=Object.assign({},{top:0,containInParent:!0,emitMessage:!1},n)}return r()(t,[{key:"init",value:function(){var t=this,e=this.element.parentElement;e&&(d.a.measure((function(){t.offsetFromParent=t.element.getBoundingClientRect().top-e.getBoundingClientRect().top}),this),l.a.on("window:throttledScroll",this.updatePosition.bind(this)),d.a.measure(this.updatePosition,this))}},{key:"updatePosition",value:function(){var t=this,e=this.element.parentElement;if(e){var n,i,o,a=this.element.getBoundingClientRect(),r=e.getBoundingClientRect(),s=a.height;if(r.top+this.offsetFromParent>0)o=!1,n={top:""},i="unfixed";else{o=!0;var c=this.opts.containInParent&&r.bottom<=a.height?Math.floor(r.bottom-s-this.opts.top):this.opts.top;n={top:"".concat(c,"px")},i="fixed"}this.opts.emitMessage&&i&&i!==this.lastMessage&&(this.emitMessage(i),this.lastMessage=i),n&&d.a.mutate((function(){o?t.element.classList.add("is-sticky"):t.element.classList.remove("is-sticky"),Object.assign(t.element.style,n)}),this)}}},{key:"emitMessage",value:function(t){l.a.emit("modules:".concat(this.element.id,":").concat(t))}}]),t}()},399:function(t,e,n){var i=n(47),o=n(291),a=n(400),r=n(401);function s(e){var n="function"==typeof Map?new Map:void 0;return t.exports=s=function(t){if(null===t||!a(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return r(t,arguments,i(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)},s(e)}t.exports=s},400:function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},401:function(t,e,n){var i=n(291),o=n(402);function a(e,n,r){return o()?t.exports=a=Reflect.construct:t.exports=a=function(t,e,n){var o=[null];o.push.apply(o,e);var a=new(Function.bind.apply(t,o));return n&&i(a,n.prototype),a},a.apply(null,arguments)}t.exports=a},402:function(t,e){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},408:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var i=n(21),o=n.n(i),a=n(27),r=n.n(a),s=n(78),c=n.n(s),l=n(79),u=n.n(l),d=n(47),h=n.n(d),f=n(32),p=n.n(f),m=n(11),g=n(58),v=n(8),b=n(146),y=n.n(b);var w=new Promise((function(t,e){v.a.on("modules:onward:geo-most-popular:ready",t),v.a.on("modules:onward:geo-most-popular:cancel",t),v.a.on("modules:onward:geo-most-popular:error",e)})),x=function(t){c()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=h()(t);if(e){var o=h()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return u()(this,n)}}(n);function n(){var t;return o()(this,n),(t=e.call(this)).endpoint="/most-read-geo.json",v.a.emit("register:begin","geo-most-popular"),t}return r()(n,null,[{key:"error",value:function(t){v.a.emit("modules:onward:geo-most-popular:error",t)}}]),r()(n,[{key:"ready",value:function(){v.a.emit("register:end","geo-most-popular"),v.a.emit("modules:onward:geo-most-popular:ready",this)}}]),n}(g.a),j=function(t){t>1500&&(new x).fetch(p()(".js-components-container"),"rightHtml")},_={render:y()((function(){return m.a.measure((function(){var t=document.querySelector(".js-article__body");return t?t.getBoundingClientRect()&&t.getBoundingClientRect().height:0})).then(j),w})),whenRendered:w}},411:function(t,e,n){"use strict";var i=n(21),o=n.n(i),a=n(27),r=n.n(a),s=n(2),c=n.n(s),l=n(101),u=function(){function t(e){o()(this,t),c()(this,"context",void 0),c()(this,"states",void 0),c()(this,"debug",void 0),c()(this,"onChangeState",void 0),this.context=e.context,this.states=e.states||{},this.context.state=e.initial||"",this.debug=e.debug||!1,this.onChangeState=e.onChangeState.bind(this.context)||function(){}}return r()(t,[{key:"log",value:function(){var t;this.debug&&window.console&&window.console.log&&(t=window.console).log.apply(t,arguments)}},{key:"trigger",value:function(t,e){this.log("fsm: (event)",t);var n=this.context.state;(this.states[n].events[t]||l.a).call(this.context,e),(n!==this.context.state||this.context.reloadState)&&(this.context.reloadState=!1,this.onChangeState(n,this.context.state),(this.states[n].leave||l.a).apply(this.context),(this.states[this.context.state].enter||l.a).apply(this.context),this.log("fsm: (state)","".concat(n," -> ").concat(this.context.state)))}}]),t}();e.a=u},412:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(17),o=n.n(i),a=n(210),r=function(t){Object(a.a)("flashing-elements")?t&&t():o.a.mutate((function(){document.body&&document.body.classList.add("disable-flashing-elements"),t&&t()}))}},416:function(t,e){t.exports='<div class="sharecount__heading"><%=icon%><span class="sharecount__text u-h">Shares</span></div>\n<div class="sharecount__value sharecount__value--full">0</div>\n<div class="sharecount__value sharecount__value--short">0</div>\n'},417:function(t,e){t.exports='<%= icon %><span class="sharecount__value sharecount__value--short">0</span> Shares\n'},421:function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));var i,o,a=n(506),r=n.n(a),s=n(12),c=n(181),l=n(412),u=n(444),d=n(11),h=function(){d.a.measure((function(){return{lastModifiedElm:document.querySelector(".js-lm"),webPublicationDateElm:document.querySelector(".js-wpd")}})).then((function(t){var e=t.lastModifiedElm,n=t.webPublicationDateElm;e&&n&&(d.a.mutate((function(){n.classList.add("content__dateline-wpd--modified")})),n.addEventListener("click",(function(){d.a.mutate((function(){e.classList.toggle("u-h")}))})))}))},f=n(20),p=n.n(f),m=n(507),g=n.n(m),v=n(0),b=n(13),y=n(8),w=n(208),x=n(40),j=n.n(x),_=Object(w.a)("shareTwitter",["icon","centered-icon"]),k=Object(w.a)("shareEmail",["icon","centered-icon"]),C='\n    <div class="selection-sharing">\n        <ul class="social u-unstyled u-cf" data-component="social-selection">\n            <li class="social__item" data-link-name="twitter">\n                <a  class="rounded-icon social-icon social-icon--twitter js-selection-twitter"\n                    data-link-name="social-selection"\n                    target="_blank"\n                    href="#">\n                    <span class="u-h">Share on Twitter</span>\n                    '.concat(_,'\n                </a>\n            </li>\n            <li class="social__item" data-link-name="email">\n                <a  class="rounded-icon social-icon social-icon--email js-selection-email"\n                    data-link-name="social-selection"\n                    target="_blank"\n                    href="#">\n                    <span class="u-h">Share via Email</span>\n                    ').concat(k,"\n                </a>\n            </li>\n        </ul>\n    </div>\n"),E=s.a.create(C),T=["js-article__body","content__standfirst","block","caption--main","content__headline"],O=function(){E.hasClass("selection-sharing--active")&&E.removeClass("selection-sharing--active")},S=function(){var t=window.getSelection&&document.createRange&&window.getSelection(),e=document.body;if(e&&t&&t.rangeCount>0&&t.toString()){var n=t.getRangeAt(0),a=g.a.getBoundingClientRect(n);if(!a)return;var r=Object(s.a)(e).scrollTop()+a.top,c=n.toString();if(!function(t){return T.some((function(e){return s.a.ancestor(t.startContainer,e)&&s.a.ancestor(t.endContainer,e)}))}(n))return void O();c.length>252&&(c="".concat(c.slice(0,251),"…"));var l=encodeURIComponent(c),u="".concat(v.a.get("page.host")).concat(v.a.get("page.shortUrlId"),"/stw"),d=encodeURI(u),h="https://twitter.com/intent/tweet?text=%E2%80%9C".concat(l,"%E2%80%9D&url=").concat(encodeURI(d)),f=encodeURI(v.a.get("page.webTitle")),p=encodeURI(n.toString()),m="".concat(v.a.get("page.host")).concat(v.a.get("page.shortUrlId"),"/sbl"),b=encodeURI(m),y="mailto:?subject=".concat(f,"&body=%E2%80%9C").concat(p,"%E2%80%9D ").concat(b);i.attr("href",h),o.attr("href",y),E.css({top:"".concat(r,"px"),left:"".concat(a.left,"px")}),E.hasClass("selection-sharing--active")||E.addClass("selection-sharing--active")}else O()},R=function(t){t.target.closest(".social__item")||O()},A=function(){document.body&&!Object(b.j)()&&(document.body.appendChild(E[0]),i=Object(s.a)(".js-selection-twitter"),o=Object(s.a)(".js-selection-email"),p.a.on(document.body,"keypress keydown keyup",j()(S,50)),p.a.on(document.body,"mouseup",j()(S,200)),p.a.on(document.body,"mousedown",j()(R,50)),y.a.on("window:throttledResize",S))},I=function(){Object(s.a)(".fenced").each(r.a.render)},L=function(){Object(u.b)(),Object(u.a)()},M=function(){Object(c.b)([["trail-a11y",l.a],["trail-fence",I],["trail-twitter",L],["trail-sharing",A],["trail-last-modified",h]])}},443:function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return g}));var i=n(15),o=n.n(i),a=n(11),r=n(0),s=n(13),c=n(6),l=n(8),u=n(9),d=n(391),h=n(145),f=function(t,e){return a.a.mutate((function(){t.innerHTML=e.html,t.classList.remove("element-rich-link--not-upgraded"),t.classList.add("element-rich-link--upgraded"),Array.from(document.getElementsByClassName("submeta-container--break")).forEach((function(t){t.classList.remove("submeta-container--break")})),l.a.emit("rich-link:loaded",t)}))},p=function(t){var e=t.querySelector("a");if(!e)return Promise.resolve();var n=e.href,i=r.a.get("page.host"),l=n.split(i),d=Object(s.m)({max:"mobileLandscape"});return l&&l[1]?Object(c.a)("/embed/card".concat(l[1],".json"),{mode:"cors"}).then((function(e){e.html&&(d?function(t){return a.a.measure((function(){var e=t.getBoundingClientRect(),n=window.innerHeight||document.documentElement&&document.documentElement.clientHeight||0;return e.top>n}))}(t).then((function(n){n&&f(t,e)})):f(t,e),function(t){h.a.adFree?a.a.mutate((function(){o()(t.children).filter((function(t){return t.classList.toString().includes("rich-link--paidfor")})).forEach((function(t){return t.classList.add("u-h")}))})):Promise.resolve()}(t))})).catch((function(t){Object(u.a)(t,{feature:"rich-links"})})):Promise.resolve()},m=function(t){return t.includes(r.a.get("page.richLink"))},g=function(){var t,e=Array.from(document.querySelectorAll(".element-rich-link a")).map((function(t){return t.href})).some(m),n=r.a.get("page.shouldHideAdverts")||!r.a.get("page.showRelatedContent"),i=document.querySelectorAll(".js-article__body--type-numbered-list").length>0;return!r.a.get("page.richLink")||r.a.get("page.richLink").includes(r.a.get("page.pageId"))||n||e||i?Promise.resolve():d.a.fillSpace({bodySelector:".js-article__body",slotSelector:" > p",minAbove:200,minBelow:250,clearContentMeta:50,selectors:{" > h2":{minAbove:"mobile"===Object(s.d)()?20:0,minBelow:200}," > *:not(p):not(h2):not(blockquote)":{minAbove:35,minBelow:300}," .ad-slot":{minAbove:150,minBelow:200}," .element-rich-link":{minAbove:500,minBelow:500}," .element--showcase":{minAbove:["desktop","leftCol","wide"].includes(Object(s.d)())?200:0,minBelow:0}}},(function(e){var n,i,o=(n={href:r.a.get("page.richLink")},'<aside class=" element element-rich-link element-rich-link--tag\n                    element--thumbnail element-rich-link--not-upgraded"\n            data-component="rich-link-tag"\n            data-link-name="rich-link-tag"\n            >\n        <p><a href="'.concat(i=n.href,'">').concat(i,"</a></p>\n    </aside>"));return e[0].insertAdjacentHTML("beforebegin",o),t=e[0].previousElementSibling})).then((function(e){if(e&&t)return p(t)}))},v=function(){Array.from(document.getElementsByClassName("element-rich-link--not-upgraded")).forEach(p)}},444:function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return d}));var i=n(17),o=n.n(i),a=n(0),r=n(13),s=n(8),c=n(40),l=n.n(c),u=document.querySelector(".js-liveblog-body, .js-article__body, .js-article__body--minute-article"),d=function(){if(("mobile"!==Object(r.d)()||a.a.get("page.isMinuteArticle"))&&a.a.get("switches.enhanceTweets")){var t=Array.from(document.querySelectorAll("blockquote.js-tweet")),e=Object(r.g)().height;t.forEach((function(t){var n=t.getBoundingClientRect();2.5*e>n.top&&n.top+n.height>0&&o.a.mutate((function(){t.classList.remove("js-tweet"),t.classList.add("twitter-tweet"),function(){var t=Array.from(document.querySelectorAll("blockquote.twitter-tweet")),e=document.getElementById("twitter-widget");if(t.length){if(!e){var n=document.createElement("script"),i=document.scripts[0];n.id="twitter-widget",n.async=!0,n.src="//platform.twitter.com/widgets.js",i&&i.parentNode&&i.parentNode.insertBefore(n,i)}"undefined"!=typeof twttr&&twttr.widgets&&twttr.widgets.load&&twttr.widgets.load(u)}}()}))}))}},h=function(){s.a.on("window:throttledScroll",l()(d,200))}},506:function(t,e,n){var i;void 0===(i=function(){var t="fenced",e="fenced-rendered";function n(t){setTimeout((function(){!function t(e,n,i,o){o=o||0,e(),n>0&&setTimeout((function(){t(e,n-1,i+o,i)}),i)}((function(){var e,n,i;(i=(n=(e=t).contentWindow&&e.contentWindow.document)&&n.body)&&(i.style.padding=0,i.style.margin=0,i.style.overflow="hidden"),function(t){var e=t.contentWindow&&t.contentWindow.document;if(e){var n=e.documentElement&&e.documentElement.scrollHeight||e.body&&e.body.scrollHeight||0;t.style.height=n+"px"}}(t)}),12,300)}),0)}function i(t,e){return t.classList?t.classList.contains(e):-1!==t.className.indexOf(e)}function o(o,a){if(a=a||{},"IFRAME"!==o.tagName)throw new Error("Cannot render non-iframe elements!");if(!i(o,t))throw new Error("Cannot render iframes with no fenced class!");var r=i(o,e);if(!r||a.force){var s,c;if(o.style.height=0,o.frameBorder=0,o.style.border="none",o.style.overflow="hidden",o.width="100%",o.srcdoc)"complete"===o.contentWindow.document.readyState?n(o):r||o.addEventListener("load",(function(){n(o)}),!1);else{var l=o.getAttribute("srcdoc");l&&"string"==typeof l&&(o.contentWindow.contents=l,o.src='javascript:window["contents"]',n(o))}c=e,(s=o).classList?s.classList.add(c):s.className+=" "+c}}function a(t){var e=document.createElement("div");e.innerHTML=(t||"").trim();var n=e.firstChild,i=n&&"IFRAME"===n.tagName,o=n&&!n.nextSibling;return i&&o}return{render:o,renderAll:function(){for(var t=document.querySelectorAll("iframe.fenced"),e=0,n=t.length;e<n;++e)o(t[e])},isSafeCode:a,wrap:function(e){return a(e)?e:'<iframe srcdoc="<html><head></head><body>'+(n=e,i=document.createElement("div"),i.appendChild(document.createTextNode(n)),i.innerHTML).replace(/\"/g,"&quot;")+'</body></html>" class="'+t+'"></iframe>';var n,i}}}.call(e,n,e,t))||(t.exports=i)},507:function(t,e,n){var i,o;
/*!
 * RangeFix v0.2.5
 * https://github.com/edg2s/rangefix
 *
 * Copyright 2014-17 Ed Sanders.
 * Released under the MIT license
 */void 0===(o="function"==typeof(i=function(){var t,e={};function n(){var e,n,i,o,a,r,s,c;return void 0===t&&(n=document.createElement("p"),i=document.createElement("span"),o=document.createTextNode("aa"),a=document.createTextNode("aa"),(r=document.createElement("img")).setAttribute("src","#null"),s=document.createRange(),t={},n.appendChild(o),n.appendChild(i),i.appendChild(r),i.appendChild(a),document.body.appendChild(n),s.setStart(o,1),s.setEnd(i,0),t.getClientRects=t.getBoundingClientRect=s.getClientRects().length>1,t.getClientRects||(s.setEnd(a,1),t.getClientRects=t.getBoundingClientRect=s.getClientRects().length<3),t.getBoundingClientRect||(s.setEnd(s.startContainer,s.startOffset),e=s.getBoundingClientRect(),t.getBoundingClientRect=0===e.top&&0===e.left),document.body.removeChild(n),c=window.ActiveXObject&&new Function("/*@cc_on return @_jscript_version; @*/")(),t.ieZoom=c&&c<=10),t}function i(t){var e;return t?screen.deviceXDPI===screen.logicalXDPI?t:"length"in t?Array.prototype.map.call(t,i):(e=screen.deviceXDPI/screen.logicalXDPI,{top:t.top/e,bottom:t.bottom/e,left:t.left/e,right:t.right/e,width:t.width/e,height:t.height/e}):t}function o(t,e){var n,i=0;if(1024>=e.length)return Array.prototype.push.apply(t,e);for(;i<e.length;)n=Array.prototype.push.apply(t,Array.prototype.slice.call(e,i,i+1024)),i+=1024;return n}return e.getClientRects=function(t){var e,a,r,s,c=n();if(c.ieZoom)return i(t.getClientRects());if(!c.getClientRects)return t.getClientRects();for(e=[],a=t.endContainer,r=t.endOffset,s=document.createRange();a!==t.commonAncestorContainer;)s.setStart(a,0),s.setEnd(a,r),o(e,s.getClientRects()),r=Array.prototype.indexOf.call(a.parentNode.childNodes,a),a=a.parentNode;return(s=t.cloneRange()).setEnd(a,r),o(e,s.getClientRects()),e},e.getBoundingClientRect=function(t){var e,o,a,r,s,c,l=this.getClientRects(t);if(0===l.length)return null;if(s=t.getBoundingClientRect(),(c=n()).ieZoom)return i(s);if(!c.getBoundingClientRect)return s;if(0===s.width&&0===s.height)return l[0];for(e=0,o=l.length;e<o;e++)r=l[e],a?(a.left=Math.min(a.left,r.left),a.top=Math.min(a.top,r.top),a.right=Math.max(a.right,r.right),a.bottom=Math.max(a.bottom,r.bottom)):a={left:r.left,top:r.top,right:r.right,bottom:r.bottom};return a&&(a.width=a.right-a.left,a.height=a.bottom-a.top),a},e})?i.call(e,n,e,t):i)||(t.exports=o)},510:function(t,e){t.exports='<details class="campaign campaign--snippet">\n\n    <summary class="campaign--snippet__header">\n        <div class="campaign--kicker">\n            <div class="campaign--snippet__heading-logo">\n                <div class="speech-bubble">\n                    <h4>Share your story</h4>\n                </div>\n            </div>\n            <div class="campaign--snippet__heading-text">\n                <h4 class="campaign--snippet__headline"> <%= data.title %></h4>\n                <%= data.description %>\n            </div>\n            <div class="success_box">\n                <p class="success-message">Thank you for your contribution</p>\n            </div>\n        </div>\n        <span class="campaign__button campaign__button--large campaign__button--rounded campaign--snippet__handle" aria-hidden="true">\n            <span class="is-off">\n                <svg class="icon icon--plus " viewBox="0 0 18 18">\n                    <path d="M8.2 0h1.6l.4 7.8 7.8.4v1.6l-7.8.4-.4 7.8H8.2l-.4-7.8L0 9.8V8.2l7.8-.4.4-7.8z"></path>\n                </svg>\n                    Tell us\n            </span>\n            <span class="is-on">\n                <svg class="icon icon--minus " viewBox="0 0 32 32">\n                    <rect x="5" y="15" width="22" height="3"></rect>\n                </svg>\n                  Hide\n            </span>\n        </span>\n    </summary>\n\n\n    <form action="/formstack-campaign/submit" method="post" class="campaign--snippet__body">\n\n        <input name="formId" type="hidden" value="<%=data.formId%>" />\n\n        <% data.formFields.forEach(function(field) { %>\n\n        <div class="form_input form_input--<%=field.type%>">\n            <div class="form_field">\n                <label for="<%=field.name%>"\n                       class="form_field_label <% if (field.required == \'1\') { %> required <% } %>" >\n                    <%= field.label %>\n                    <% if(field.description) { %>\n                        <span>(<%= field.description %>)</span>\n                    <% } %>\n                </label>\n\n                <% if(field.type === "textarea") { %>\n                <textarea name="field_<%=field.id%>"<% if (field.required == "1") { %> required <% } %>/></textarea>\n\n                <% } else if(field.type === "radio" || field.type === "checkbox") { %>\n                <div class="form_option_container">\n                <% field.options.forEach(function(option){ %>\n                    <input type="<%=field.type%>"\n                       value="<%=option.value%>"\n                       id="<%=option.label%>"\n                       name="field_<%=field.id%>"\n                    />\n                    <label for="<%=option.label%>">\n                        <%=option.value%>\n                    </label>\n                <% }) %>\n                </div>\n\n                <% } else if(field.type === "select") { %>\n                <select name="field_<%=field.id%>"\n                <% if (field.required == "1") { %> required <% } %>\n                >\n                <% field.options.forEach(function(option){ %>\n                <option value="<%=option.value%>">\n                    <%=option.value%>\n                </option>\n                <% }) %>\n\n                </select>\n\n                <% } else if(field.type === "file") { %>\n                <input name="field_<%=field.id%>"\n                       type="file"\n                       accept="image/*, .pdf"\n                <% if (field.required == "1") { %> required <% } %>\n                />\n                <p class="form-info-text">We accept images and pdfs. Maximum total file size: 6MB</p>\n\n                <% } else { %>\n                <input name="field_<%=field.id%>"\n                       type="<%=field.type%>"\n                <% if (field.required == "1") { %> required <% } %>\n                />\n                <% } %>\n            </div>\n\n        </div>\n\n        <% }) %>\n        <div class="form_input form_input--twitter-handle" aria-hidden="true">\n            <div class="form_field">\n                <input name="twitter-handle" type="text" id="twitter-handle" placeholder="@mytwitterhandle"/>\n            </div>\n        </div>\n        <div class="form_footer">\n            <div class="form_submit">\n                <button class="button button--rounded" type="submit">Share with the Guardian</button>\n            </div>\n            <div class="t_and_c">\n                <a href="https://www.theguardian.com/help/terms-of-service">Terms and conditions</a>\n            </div>\n        </div>\n        <div class="error_box"></div>\n\n    </form>\n\n</details>\n'},511:function(t,e){t.exports='<li class="<%=articleType%>-lightbox__item <%=articleType%>-lightbox__item--img js-<%=articleType%>-slide">\n    <div class="<%=articleType%>-lightbox__img-container"><img class="<%=articleType%>-lightbox__img js-<%=articleType%>-lightbox-img"></div>\n    <div class="<%=articleType%>-lightbox__info js-<%=articleType%>-lightbox-info">\n        <div class="<%=articleType%>-lightbox__progress <%=articleType%>-lightbox__progress--info">\n            <span class="<%=articleType%>-lightbox__index"><%=index%></span>\n            <span class="<%=articleType%>-lightbox__progress-separator"></span>\n            <span class="<%=articleType%>-lightbox__count"><%=count%></span>\n            </div>\n        <div class="<%=articleType%>-lightbox__img-caption"><%=caption%></div>\n        <div class="<%=articleType%>-lightbox__img-credit"><%=credit%></div>\n        <div class="block-share block-share--<%=articleType%>" data-link-name="block share">\n            <%=shareButtons%>\n        </div>\n</li>\n'},512:function(t,e){t.exports='<div class="gallery-lightbox__btn gallery-lightbox__btn--<%=label%> js-gallery-<%=label%>">\n<button data-link-name="gallery-lightbox <%=label%>" class="gallery-lightbox__btn-body"><i></i><%=label%></button>\n</div>'},513:function(t,e){t.exports='<li class="gallery-lightbox__item gallery-lightbox__item--endslate js-gallery-slide">\n<div class="gallery-lightbox__endslate js-gallery-endslate fc-container--media"></div>\n</li>'},514:function(t,e){t.exports='<div class="pamplemousse gallery-lightbox__loader js-loader">\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n</div>'},515:function(t,e){t.exports='<a class="rounded-icon block-share__item block-share__item--<%=css%> js-blockshare-link" href="<%=url%>" target="_blank" data-link-name="social <%=css%>">\n    <span class="u-h"><%=text%></span>\n    <%= icon %>\n</a>\n'},578:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return Z})),n.d(e,"_",(function(){return G}));var i=n(24),o=n.n(i),a=n(2),r=n.n(a),s=n(21),c=n.n(s),l=n(27),u=n.n(l),d=n(78),h=n.n(d),f=n(79),p=n.n(f),m=n(47),g=n.n(m),v=n(20),b=n.n(v),y=n(5),w=n.n(y),x=n(32),j=n.n(x),_=n(12),k=n(0),C=n(13),E=n(411),T=n(8),O=n(207),S=n.n(O),R=n(183),A=n.n(R),I=n(14),L=n(58),M=n(208),P=n(511),$=n.n(P),B=n(512),q=n.n(B),H=n(513),D=n.n(H),z=n(514),N=n.n(z),F=n(515),U=n.n(F),W=n(397),J=n(67);var K=function(t){var e=w()(t);e.addClass("gallery-lightbox__button-pulse"),window.setTimeout((function(){e.removeClass("gallery-lightbox__button-pulse")}),75)},X=function(t){h()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g()(t);if(e){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}(n);function n(){return c()(this,n),e.apply(this,arguments)}return u()(n,[{key:"prerender",value:function(){w()(this.elem).addClass(this.componentClass)}}]),n}(L.a),V=function(){function t(){var e=this;c()(this,t),r()(this,"showEndslate",void 0),r()(this,"useSwipe",void 0),r()(this,"swipeThreshold",void 0),r()(this,"lightboxEl",void 0),r()(this,"$lightboxEl",void 0),r()(this,"$indexEl",void 0),r()(this,"$countEl",void 0),r()(this,"$contentEl",void 0),r()(this,"nextBtn",void 0),r()(this,"prevBtn",void 0),r()(this,"closeBtn",void 0),r()(this,"infoBtn",void 0),r()(this,"$swipeContainer",void 0),r()(this,"resize",void 0),r()(this,"toggleInfo",void 0),r()(this,"fsm",void 0),r()(this,"states",void 0),r()(this,"images",void 0),r()(this,"swipeContainerWidth",void 0),r()(this,"$slides",void 0),r()(this,"index",void 0),r()(this,"$images",void 0),r()(this,"galleryJson",void 0),r()(this,"bodyScrollPosition",void 0),r()(this,"endslateEl",void 0),r()(this,"endslate",void 0),r()(this,"startIndex",void 0),r()(this,"handleKeyEvents",void 0),r()(this,"endslate",new X),r()(this,"states",{closed:{enter:function(){this.hide()},leave:function(){this.show(),Object(I.g)({},document.title,"/".concat(this.galleryJson.id))},events:{open:function(){this.swipe&&this.swipe.slide(this.index,0),this.state="image"},loadJson:function(t){this.galleryJson=t,this.loadHtml(t),this.showEndslate&&this.loadEndslate(),this.$slides=Object(_.a)(".js-gallery-slide",this.$contentEl[0]),this.useSwipe&&this.initSwipe(),this.state="image"}}},image:{enter:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,this.useSwipe&&Object(C.m)({max:"tablet"})?100:0),Object(I.g)({},document.title,"/".concat(this.galleryJson.id,"#img-").concat(this.index),!0),b.a.on(this.$swipeContainer[0],"click",".js-gallery-content",this.toggleInfo),T.a.on("window:throttledResize",this.resize),this.$indexEl.text(this.index)},leave:function(){b.a.off(this.$swipeContainer[0],"click",this.toggleInfo),T.a.off("window:throttledResize",this.resize)},events:{next:function(){K(this.nextBtn),this.index===this.images.length?this.showEndslate?this.state="endslate":(this.index=1,this.reloadState=!0):(this.index+=1,this.reloadState=!0)},prev:function(){K(this.prevBtn),1===this.index?this.showEndslate?this.state="endslate":(this.index=this.images.length,this.reloadState=!0):(this.index-=1,this.reloadState=!0)},reload:function(){this.reloadState=!0},toggleInfo:function(){K(this.infoBtn),this.$lightboxEl.toggleClass("gallery-lightbox--show-info")},hideInfo:function(){K(this.infoBtn),this.$lightboxEl.removeClass("gallery-lightbox--show-info")},showInfo:function(){K(this.infoBtn),this.$lightboxEl.addClass("gallery-lightbox--show-info")},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,0)},close:function(){this.state="closed"}}},endslate:{enter:function(){this.translateContent(this.$slides.length,0,0),this.index=this.images.length+1,T.a.on("window:throttledResize",this.resize)},leave:function(){T.a.off("window:throttledResize",this.resize)},events:{next:function(){K(this.nextBtn),this.index=1,this.state="image"},prev:function(){K(this.prevBtn),this.index=this.images.length,this.state="image"},reload:function(){this.reloadState=!0},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.translateContent(this.$slides.length,0,0)},close:function(){this.state="closed"}}}}),this.showEndslate="mobile"!==Object(C.d)()&&"childrens-books-site"!==k.a.get("page.section")&&"Gallery"===k.a.get("page.contentType"),this.useSwipe=Object(C.j)(),this.swipeThreshold=.05,this.handleKeyEvents=this.unboundHandleKeyEvents.bind(this);var n=function(t){var e=q.a;return S()(e)({label:t})},i='<div class="overlay gallery-lightbox gallery-lightbox--closed gallery-lightbox--hover">\n                <div class="gallery-lightbox__sidebar">\n                    '.concat(n("close"),'\n                    <div class="gallery-lightbox__progress  gallery-lightbox__progress--sidebar">\n                        <span class="gallery-lightbox__index js-gallery-index"></span>\n                        <span class="gallery-lightbox__progress-separator"></span>\n                        <span class="gallery-lightbox__count js-gallery-count"></span>\n                    </div>\n                    ').concat(n("next"),"\n                    ").concat(n("prev"),"\n                    ").concat(n("info-button"),'\n                </div>\n                <div class="js-gallery-swipe gallery-lightbox__swipe-container">\n                    <ul class="gallery-lightbox__content js-gallery-content"></ul>\n                </div>\n            </div>');this.lightboxEl=w.a.create(i),this.$lightboxEl=w()(this.lightboxEl).prependTo(document.body),this.$indexEl=Object(_.a)(".js-gallery-index",this.lightboxEl),this.$countEl=Object(_.a)(".js-gallery-count",this.lightboxEl),this.$contentEl=Object(_.a)(".js-gallery-content",this.lightboxEl),this.nextBtn=j()(".js-gallery-next",this.lightboxEl)[0],this.prevBtn=j()(".js-gallery-prev",this.lightboxEl)[0],this.closeBtn=j()(".js-gallery-close",this.lightboxEl)[0],this.infoBtn=j()(".js-gallery-info-button",this.lightboxEl)[0],this.$swipeContainer=Object(_.a)(".js-gallery-swipe"),b.a.on(this.nextBtn,"click",this.trigger.bind(this,"next")),b.a.on(this.prevBtn,"click",this.trigger.bind(this,"prev")),b.a.on(this.closeBtn,"click",this.close.bind(this)),b.a.on(this.infoBtn,"click",this.trigger.bind(this,"toggleInfo")),this.resize=this.trigger.bind(this,"resize"),this.toggleInfo=function(t){w()(t.target).hasClass("js-gallery-lightbox-info")||_.a.ancestor(t.target,"js-gallery-lightbox-info")||e.trigger("toggleInfo")},Object(C.j)()&&this.disableHover(),b.a.on(window,"popstate",(function(t){t.state||e.trigger("close")})),this.fsm=new E.a({initial:"closed",onChangeState:function(t,e){this.$lightboxEl.removeClass("gallery-lightbox--".concat(t)).addClass("gallery-lightbox--".concat(e))},context:this,states:this.states})}return u()(t,[{key:"generateImgHTML",value:function(t,e){var n=k.a.get("page.host")+k.a.get("page.shortUrlId"),i=t.src.startsWith("//")?"http:":"",o=[{text:"Facebook",css:"facebook",icon:Object(M.a)("shareFacebook",["icon"]),url:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent("".concat(n,"/sfb#img-").concat(e)))},{text:"Twitter",css:"twitter",icon:Object(M.a)("shareTwitter",["icon"]),url:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(k.a.get("page.webTitle")),"&url=").concat(encodeURIComponent("".concat(n,"/stw#img-").concat(e)))},{text:"Pinterest",css:"pinterest",icon:Object(M.a)("sharePinterest",["icon"]),url:encodeURI("http://www.pinterest.com/pin/create/button/?description=".concat(k.a.get("page.webTitle"),"&url=").concat(n,"&media=").concat(i).concat(t.src))}];return S()($.a.replace(/^\s+|\s+$/gm,""))({articleType:"gallery",count:this.images.length,index:e,caption:t.caption,credit:t.displayCredit?t.credit:"",shareButtons:o.map((function(t){return S()(U.a)(t)})).join("")})}},{key:"initSwipe",value:function(){var t,e,n,i=this;b.a.on(this.$swipeContainer[0],"touchstart",(function(o){t=i.swipeContainerWidth*i.swipeThreshold,e=o.touches[0].pageX,n=0})),b.a.on(this.$swipeContainer[0],"touchmove",A()((function(t){t.preventDefault(),t.touches.length>1||t.scale&&1!==t.scale||(n=t.touches[0].pageX-e,i.translateContent(i.index,n,20))}),20,{trailing:!1})),b.a.on(this.$swipeContainer[0],"touchend",(function(){var e;e=Math.abs(n)>t?n>t?1:-1:0,n=0,1===e?i.index>1?i.trigger("prev"):i.trigger("reload"):-1===e&&i.index<i.$slides.length?i.trigger("next"):i.trigger("reload")}))}},{key:"disableHover",value:function(){this.$lightboxEl.removeClass("gallery-lightbox--hover")}},{key:"trigger",value:function(t,e){this.fsm.trigger(t,e)}},{key:"loadOrOpen",value:function(t,e){this.index=e,this.galleryJson&&t.id===this.galleryJson.id&&t.images.length===this.galleryJson.images.length?this.trigger("open"):this.trigger("loadJson",t)}},{key:"fetchSurroundingJson",value:function(e){var n=this;if("ImageContent"===k.a.get("page.contentType")&&e.images.length<2){var i=window.location.pathname.substring(1);return Promise.all([t.loadNextOrPrevious(i,"forwards"),t.loadNextOrPrevious(i,"backwards")]).then((function(t){var e=o()(t,2),n=e[0],i=e[1];return{next:n.map((function(t){return t.images[0]})),previous:i.map((function(t){return t.images[0]}))}})).then((function(t){var i=t.next,o=t.previous,a=o.reverse().concat(e.images,i);return a.length<2&&(w()([n.nextBtn,n.prevBtn]).hide(),Object(_.a)(".gallery-lightbox__progress",n.lightboxEl).hide()),e.images=a,n.startIndex=o.length+1,e}))}return Promise.resolve(e)}},{key:"loadHtml",value:function(t){var e=this;this.images=t.images||[];var n=t.images.map((function(t,n){return e.generateImgHTML(t,n+1)})).join("");this.$contentEl.html(n),this.$images=Object(_.a)(".js-gallery-lightbox-img",this.$contentEl[0]),this.$countEl.text(this.images.length)}},{key:"loadSurroundingImages",value:function(t,e){var n,i,o=this;[-1,0,1].map((function(n){return t+n===0?e-1:(t-1+n)%e})).forEach((function(t){n=o.images[t],(i=w()(o.$images[t])).attr("src")||(i.parent().append(w.a.create(N.a)),i.attr("src",n.src),i.attr("srcset",n.srcsets),i.attr("sizes",n.sizes),b.a.one(i[0],"load",(function(){Object(_.a)(".js-loader").remove()})))}))}},{key:"translateContent",value:function(t,e,n){var i=-1*(t-1)*this.swipeContainerWidth,o=this.$contentEl[0];Object.assign(o.style,{webkitTransitionDuration:"".concat(n,"ms"),mozTransitionDuration:"".concat(n,"ms"),msTransitionDuration:"".concat(n,"ms"),transitionDuration:"".concat(n,"ms"),webkitTransform:"translate(".concat(i+e,"px,0) translateZ(0)"),mozTransform:"translate(".concat(i+e,"px,0)"),msTransform:"translate(".concat(i+e,"px,0)"),transform:"translate(".concat(i+e,"px,0) translateZ(0)")})}},{key:"show",value:function(){var t=w()(document.body);this.bodyScrollPosition=t.scrollTop(),t.addClass("has-overlay"),this.$lightboxEl.addClass("gallery-lightbox--open"),b.a.off(document.body,"keydown",this.handleKeyEvents),b.a.on(document.body,"keydown",this.handleKeyEvents)}},{key:"close",value:function(){I.i?Object(I.a)():this.trigger("close"),this.trigger("close")}},{key:"hide",value:function(){var t=this,e=w()(document.body);e.removeClass("has-overlay"),b.a.off(document.body,"keydown",this.handleKeyEvents),window.setTimeout((function(){t.bodyScrollPosition&&e.scrollTop(t.bodyScrollPosition),t.$lightboxEl.removeClass("gallery-lightbox--open"),T.a.emit("ui:images:vh")}),1)}},{key:"unboundHandleKeyEvents",value:function(t){37===t.keyCode?this.trigger("prev"):39===t.keyCode?this.trigger("next"):38===t.keyCode?this.trigger("showInfo"):40===t.keyCode?this.trigger("hideInfo"):27===t.keyCode?this.close():73===t.keyCode&&this.trigger("toggleInfo")}},{key:"loadEndslate",value:function(){!this.endslate.rendered&&this.$contentEl&&(this.endslateEl=w.a.create(D.a),this.$contentEl.append(this.endslateEl),this.endslate.componentClass="gallery-lightbox__endslate",this.endslate.endpoint="/gallery/most-viewed.json",this.endslate.fetch(j()(".js-gallery-endslate",this.endslateEl),"html"))}}],[{key:"loadNextOrPrevious",value:function(t,e){var n="forwards"===e?"getnext":"getprev",i=k.a.get("page.nonKeywordTagIds","").split(",").filter((function(t){return t.includes("series")}))[0],o="/".concat(n,"/").concat(i,"/").concat(t);return Object(J.a)(o).then((function(t){return t.json()})).then((function(t){return t.filter((function(t){return t.images.length>0}))}))}}]),t}(),Z=function(){W.a.then((function(){var t=k.a.get("page.lightboxImages");if(t&&t.images.length>0){var e=new V,n=window.location.hash;b.a.on(document.body,"click",".js-gallerythumbs",(function(n){n.preventDefault();var i=w()(n.currentTarget),o=(i.attr("href")||i.attr("data-gallery-url")).split("#img-"),a=parseInt(o[1],10),r=Number.isNaN(a)?1:a;e.fetchSurroundingJson(t).then((function(t){var n=e.startIndex?e.startIndex:r;e.loadOrOpen(t,n)}))}));var i="/".concat(k.a.get("page.pageId")),o=/\?index=(\d+)/.exec(document.location.href),a=/^#(?:img-)?(\d+)$/.exec(n),r=0;o?(Object(I.g)({},document.title,i,!0),r=parseInt(o[1],10)):a&&(r=parseInt(a[1],10)),r>0&&e.fetchSurroundingJson(t).then((function(t){e.loadOrOpen(t,r)}))}}))},G={GalleryLightbox:V}},579:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return c}));var i=n(32),o=n.n(i),a=n(0),r=n(58),s=n(390),c=function(){var t,e;Object(s.initTrails)(),a.a.get("page.showRelatedContent")&&(t=new r.a,e=o()(".js-gallery-most-popular")[0],t.manipulationType="html",t.endpoint="/gallery/most-viewed.json",t.fetch(e,"html"))}},592:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return W}));var i=n(0),o=n(32),a=n.n(o),r=n(12),s=n(181),c=n(13),l=n(8),u=n(14),d=n(443),h=n(17),f=n.n(h),p=n(6),m=n(9),g=function(t){var e=Object(r.a)("a",t).attr("href");e.match(/https:\/\/membership.theguardian.com/)&&Object(p.a)("".concat(e,"/card"),{mode:"cors"}).then((function(e){e.html&&f.a.mutate((function(){Object(r.a)(t).html(e.html).removeClass("element-membership--not-upgraded").addClass("element-membership--upgraded")}))})).catch((function(t){Object(m.a)(t,{feature:"membership-events"})}))},v=function(){Object(r.a)(".".concat("element-membership--not-upgraded")).each(g)},b=n(408),y=n(20),w=n.n(y),x=n(11),j=function(){if(HTMLFormElement.prototype.checkValidity){var t=Array.from(document.getElementsByClassName("js-atom-quiz--instant-reveal"));t.length&&w.a.on(document,"click",t,(function t(e){var n=e.currentTarget,i=n.querySelectorAll(":checked + .atom-quiz__answer__item--is-correct").length;if(n.checkValidity()){var o=function(){var e=n.querySelector(".js-atom-quiz__bucket-message--".concat(i));if(e)return x.a.mutate((function(){e.style.display="block"})),w.a.off(document,"click",t),"break";i-=1};do{if("break"===o())break}while(i>=0)}}))}},_=n(421),k=n(390),C=n(207),E=n.n(C),T=n(510),O=n.n(T),S=n(31),R=n.n(S),A=n(55),I=n.n(A),L=n(67),M=i.a.get("page.calloutsUrl"),P=function(t){return t.name>""},$=function(t){var e=t.closest(".element-campaign");x.a.mutate((function(){e.classList.add("success")}))},B=function(t){var e=t.querySelector("button"),n=t.querySelector(".error_box");x.a.mutate((function(){e.textContent="Sending...",e.disabled=!0,n.innerHTML=""}))},q=function(t,e){var n=t.querySelector(".error_box");n&&x.a.mutate((function(){n.innerHTML='<p class="error">'.concat(e,"</p>")})),function(t){var e=t.getElementsByTagName("button")[0];e.disabled=!1,e.textContent="Share with the Guardian"}(t)},H=function(t,e){if(function(t){return"checkbox"===t.type}(t))return(e[t.name]||"").concat("\n".concat(t.value));if(function(t){return"file"===t.type}(t)&&t.files[0]){var n=t.closest("form");return function(t,e){return new Promise((function(n){var i=new FileReader;i.addEventListener("load",(function(){var t=i.result.toString().split(";base64,")[1];n(t)}),!1),i.addEventListener("error",(function(){q(e,"Sorry there was a problem with the file you uploaded above. Check the size and type. We only accept images, pdfs and .doc or .docx files")})),i.readAsDataURL(t)}))}(t.files[0],n)}return t.value},D=function(){var t=I()(R.a.mark((function t(e){var n,i;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=e.target,t.next=4,o=n.elements,[].reduce.call(o,function(){var t=I()(R.a.mark((function t(e,n){var i,o;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(i=t.sent,!P(n)){t.next=9;break}return t.next=6,H(n,i);case 6:return o=t.sent,i[n.name]=o,t.abrupt("return",i);case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Promise.resolve({}));case 4:if(!((i=t.sent)["twitter-handle"].length>0)){t.next=8;break}return q(n,"Sorry we think you are a robot."),t.abrupt("return",!1);case 8:return B(n),t.abrupt("return",Object(L.a)(M,{method:"post",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(t){t.ok?$(n):q(n,"Sorry, there was a problem submitting your form. Please try again later.")})).catch((function(){console.error("Request to ".concat(M," failed")),q(n,"Sorry, there was a problem submitting your form. Please try again later.")})));case 10:case"end":return t.stop()}var o}),t)})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t,e=i.a.get("page.campaigns").filter((function(t){return"callout"===t.fields._type})).reduce((function(t,e){return t[e.fields.tagName]={name:e.name,title:e.fields.callout,description:e.fields.description||"",formFields:e.fields.formFields,formId:e.fields.formId,tagName:e.fields.tagName},t}),{});(t=document.querySelectorAll("figure[data-alt]"),Array.from(t).filter((function(t){var e=t.getAttribute("data-alt");return!!e&&e.toLowerCase().startsWith("callout")}))).forEach((function(t){var n=t.getAttribute("data-alt");if(n){var i=n.toLowerCase().split(" ")[1];i in e?function(t,e){var n=E()(O.a)({data:e}),i='<figure class="element element-campaign">'.concat(n,"</figure>");x.a.mutate((function(){t.innerHTML=i})).then((function(){var e=t.querySelector(".element-campaign .campaign .campaign--snippet__body");e&&e.addEventListener("submit",D)}))}(t,e[i]):t.innerHTML=""}}))},N=n(28),F=n.n(N),U={initCmpParam:function(){var t=Object(u.d)();t.CMP&&Object(r.a)(".element-pass-cmp").each((function(e){e.src="".concat(e.src,"?CMP=").concat(t.CMP)}))},initRightHandComponent:function(){var t=a()(".js-content-main-column");!i.a.hasTone("Match reports")&&t[0]&&t[0].offsetHeight>1150&&Object(c.m)({min:"desktop"})?b.a.render():l.a.emit("modules:onward:geo-most-popular:cancel")},initQuizListeners:function(){l.a.on("quiz/ophan-event",F.a.record)},emitReadyEvent:function(){l.a.emit("page:article:ready")}},W=function(){Object(s.b)([["article-trails",k.initTrails],["article-liveblog-common",_.a],["article-righthand-component",U.initRightHandComponent],["article-cmp-param",U.initCmpParam],["article-quiz-listeners",U.initQuizListeners],["article-rich-links",d.b],["article-tag-rich-link",d.a],["article-upgrade-membership-events",v],["article-mediator-emit-event",U.emitReadyEvent],["article-handle-quiz-completion",j],["article-campaign",z]])}},596:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return P}));var i=n(0),o=n(13),a=n(8),r=n(443),s=n(21),c=n.n(s),l=n(27),u=n.n(l),d=n(2),h=n.n(d),f=n(5),p=n.n(f),m=n(11),g=function(){function t(e){var n=this;c()(this,t),h()(this,"affixed",void 0),h()(this,"$markerTop",void 0),h()(this,"$markerBottom",void 0),h()(this,"$container",void 0),h()(this,"$element",void 0),h()(this,"$window",void 0),window.addEventListener("click",(function(){n.checkPosition()})),a.a.addListener("window:throttledScroll",(function(){n.checkPosition()})),a.a.addListener("window:throttledResize",(function(){n.calculateContainerPositioning()})),this.affixed=!1,this.$markerTop=p()(e.topMarker),this.$markerBottom=p()(e.bottomMarker),this.$container=p()(e.containerElement),this.$element=p()(e.element),this.$window=p()(document.body),this.checkPosition(),this.calculateContainerPositioning()}return u()(t,[{key:"calculateContainerPositioning",value:function(){var t=this;m.a.mutate((function(){t.$container.css("top","0")})).then((function(){return m.a.measure((function(){return t.$markerTop.offset().top-t.$container.offset().top}))})).then((function(e){m.a.mutate((function(){t.$container.css("top","".concat(e,"px"))}))}))}},{key:"checkPosition",value:function(){var t,e=this,n=this.$window.scrollTop(),i=this.$markerTop.offset().top,o=this.$markerBottom.offset().top,a=this.$element.dim().height,r=n>=i,s=n+a<o,c=a<p.a.viewport().height,l=s&&r&&c;if(this.affixed!==l){if(this.affixed=l,s)m.a.mutate((function(){e.$container.removeClass("affix-bottom")})),this.calculateContainerPositioning();else{var u=o-i-a+("auto"!==(t=this.$container.css("top"))?parseInt(t,10):0);m.a.mutate((function(){e.$container.css("top","".concat(u,"px")),e.$container.addClass("affix-bottom")}))}m.a.mutate((function(){l?e.$element.addClass("affix"):e.$element.removeClass("affix")}))}}}]),t}(),v=n(20),b=n.n(v),y=n(32),w=n.n(y),x=n(12),j=n(6),_=n(444),k=n(392),C=n(222),E=n(385),T=n(216),O=function(t){var e,n=Object.assign({toastOffsetTop:12,minUpdateDelay:1e3*(Object(o.m)({min:"desktop"})?10:30),maxUpdateDelay:12e5,backoffMultiplier:.75},t),i=Object(x.a)(".js-liveblog-body"),r=Object(x.a)(".toast__button"),s=Object(x.a)(".toast__text",r),c=w()(".toast__container")[0],l=n.minUpdateDelay,u=i.data("most-recent-block"),d=0,h=!window.location.search.includes("?page="),f=function(){m.a.mutate((function(){Object(x.a)(".autoupdate--hidden",i).addClass("autoupdate--highlight").removeClass("autoupdate--hidden"),a.a.emit("modules:autoupdate:unread",0)}))},g=function(){m.a.mutate((function(){if(d>0){var t=d>1?" new updates":" new update";r.removeClass("toast__button--closed"),Object(x.a)(c).addClass("toast__container--open"),s.html(d+t)}else r.removeClass("loading").addClass("toast__button--closed"),Object(x.a)(c).removeClass("toast__container--open")}))},v=function(){Object(o.q)()&&f(),d=0,g()},y=function t(){void 0!==e&&clearTimeout(e);var r=0,s="&isLivePage=".concat(h?"true":"false"),c="?lastUpdate=".concat(u||"block-0").concat(s),f="".concat(window.location.pathname,".json").concat(c),b=function(){var i,a;0===r||l>0?(i=l,a=Object(o.q)()?n.minUpdateDelay:Math.min(1.5*i,n.maxUpdateDelay),l=a,e=setTimeout(t,l)):e=setTimeout(t,1)};return Object(j.a)(f,{mode:"cors"}).then((function(t){var e,n,o;(r=t.numNewBlocks)>0&&(d+=r,a.a.emit("modules:autoupdate:unread",d),u=t.mostRecentBlockId,h?(e=t.html,o=x.a.create("<div>".concat(e,"</div>"))[0],m.a.mutate((function(){p()(o.children).addClass("autoupdate--hidden"),n=Array.from(o.children),i.prepend(n),a.a.emit("modules:autoupdate:updates",n.length),Object(E.a)(),Object(_.a)(),Object(T.a)(n)})),i.offset().top<window.pageYOffset?g():v()):g()),b()})).catch((function(){b()}))};(function(){var t=document.title;a.a.on("modules:autoupdate:unread",(function(e){!function(t,e){document.title=t>0?"(".concat(t,") ").concat(e):e}(e,t)}))})(),new k.a(c,{top:n.toastOffsetTop,emitMessage:!0,containInParent:!1}).init(),y(),Object(o.k)(),b.a.on(document.body,"click",".toast__button",(function(){h?m.a.measure((function(){Object(C.b)(w()(".blocks")[0],300,"easeOutQuad"),m.a.mutate((function(){r.addClass("loading")})).then((function(){v()}))})):window.location.assign(window.location.pathname)})),a.a.on("modules:toast__tofix:unfixed",(function(){h&&d>0&&m.a.mutate((function(){r.addClass("loading")})).then((function(){v()}))})),a.a.on("modules:detect:pagevisibility:visible",(function(){0===d&&f(),l=0,y()})),m.a.mutate((function(){i.addClass("autoupdate--has-animation")}))},S=n(421),R=n(390),A=n(181),I=function(){var t=i.a.get("page.keywordIds","");!Object(o.m)({min:"desktop"})||t.includes("football/football")||t.includes("sport/rugby-union")||new g({element:document.querySelector(".js-live-blog__sticky-components-container"),topMarker:document.querySelector(".js-top-marker"),bottomMarker:document.querySelector(".js-bottom-marker"),containerElement:document.querySelector(".js-live-blog__sticky-components")})},L=function(){i.a.get("page.isLive")&&O()},M=function(){window.setInterval((function(){return Object(E.a)()}),6e4)},P=function(){Object(A.b)([["lb-autoupdate",L],["lb-timeline",I],["lb-timestamp",M],["lb-richlinks",r.b]]),Object(R.initTrails)(),Object(S.a)(),Object(A.b)([["lb-ready",function(){a.a.emit("page:liveblog:ready")}]])}},598:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return d}));var i=n(421),o=n(390),a=n(12),r=n(11),s=n(8),c=n(13),l=function(t){t.elements.forEach((function(e){!function(t){r.a.mutate((function(){t.$el.css("height","")})).then((function(){if(t.isMobile)return r.a.measure((function(){return t.$el.height()})).then((function(e){return r.a.mutate((function(){t.$el.css("height",e)}))}))}))}({$el:Object(a.a)(e),isMobile:t.isMobile})}))},u=function(){r.a.measure((function(){return{elements:Array.from(document.getElementsByClassName("js-is-fixed-height")),isMobile:"mobile"===Object(c.d)()}})).then(l)},d=function(){Object(i.a)(),Object(o.initTrails)(),s.a.on("window:throttledResize",u),s.a.on("window:orientationchange",u),u()}}}]);
//# sourceMappingURL=graun.article.js.map